<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Cylinder</title>
    <style>
        body {
            display: flex;
            margin: 0;
            height: 100vh;
        }
        #viewer {
            flex: 1;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        #progressBar {
            width: 100%;
            background-color: #f3f3f3;
        }
        #progressBar div {
            width: 0%;
            height: 30px;
            background-color: #4caf50;
            text-align: center;
            line-height: 30px;
            color: white;
        }
        #dropZone {
            width: 100%;
            height: 100px;
            border: 2px dashed #ccc;
            text-align: center;
            line-height: 100px;
        }
        #settings {
            width: 300px;
            padding: 20px;
            background-color: #f9f9f9;
            border-left: 1px solid #ccc;
            box-sizing: border-box;
        }
        #settings label {
            display: block;
            margin-bottom: 10px;
        }
        #settings input {
            width: 100%;
            margin-bottom: 20px;
        }
        #canvasContainer {
            flex: 1;
            position: relative;
        }
    </style>
</head>
<body>
    <div id="viewer">
        <div id="dropZone">ドラッグ＆ドロップで画像をアップロード</div>
        <div id="progressBar"><div></div></div>
        <div id="canvasContainer"></div>
    </div>
    <div id="settings">
        <label>
            上面の直径 (mm):
            <input type="number" id="topDiameter" value="70">
        </label>
        <label>
            下面の直径 (mm):
            <input type="number" id="bottomDiameter" value="70">
        </label>
        <label>
            円筒の高さ (mm):
            <input type="number" id="cylinderHeight" value="100">
        </label>
        <label>
            円筒の厚み (mm):
            <input type="number" id="cylinderThickness" value="1" step="0.1">
        </label>
        <label>
            コントラストの強度:
            <input type="number" id="contrastStrength" value="4" step="0.1">
        </label>
        <label>
            写真の貼り付け角度 (度):
            <input type="number" id="textureAngle" value="120" step="1">
        </label>
        <label>
            解像度:
            <input type="number" id="stepResolution" value="0.2" step="0.1">
        </label>
        <button id="applySettings">設定を適用</button>
        <button id="saveSettings">設定を保存</button>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/exporters/STLExporter.js"></script>
    <script>
        'use strict';
        const _0x85c3c6=_0x1be8;(function(_0x4f2d65,_0x514d2f){const _0x3ef325=_0x1be8,_0x25b280=_0x4f2d65();while(!![]){try{const _0x31db8b=parseInt(_0x3ef325(0x1ff))/0x1+-parseInt(_0x3ef325(0x1f2))/0x2*(-parseInt(_0x3ef325(0x1e6))/0x3)+parseInt(_0x3ef325(0x1bc))/0x4*(-parseInt(_0x3ef325(0x205))/0x5)+-parseInt(_0x3ef325(0x211))/0x6*(-parseInt(_0x3ef325(0x203))/0x7)+parseInt(_0x3ef325(0x1d4))/0x8*(parseInt(_0x3ef325(0x1c0))/0x9)+-parseInt(_0x3ef325(0x1b3))/0xa+parseInt(_0x3ef325(0x1b0))/0xb;if(_0x31db8b===_0x514d2f)break;else _0x25b280['push'](_0x25b280['shift']());}catch(_0xb377f1){_0x25b280['push'](_0x25b280['shift']());}}}(_0x3828,0xebfc9),document[_0x85c3c6(0x1db)](_0x85c3c6(0x20f),()=>{const _0x4e6f2b=_0x85c3c6;let _0x1a5bba=null,_0x363dde='';const _0x49dd28=new THREE[(_0x4e6f2b(0x1d9))](),_0x100a48=new THREE[(_0x4e6f2b(0x20b))](0x4b,window['innerWidth']/window[_0x4e6f2b(0x1b1)],0.1,0x3e8);_0x100a48[_0x4e6f2b(0x1ad)]['z']=0xc8;const _0x5a870d=new THREE[(_0x4e6f2b(0x1d2))](),_0x462993=document['getElementById'](_0x4e6f2b(0x1bb));_0x5a870d['setSize'](_0x462993[_0x4e6f2b(0x1ec)],_0x462993['clientHeight']),_0x462993[_0x4e6f2b(0x1d6)](_0x5a870d[_0x4e6f2b(0x1e2)]);const _0x45fe7e=new THREE['DirectionalLight'](0xffffff,0x1);_0x45fe7e['position'][_0x4e6f2b(0x20a)](0x1,0x1,0x1)[_0x4e6f2b(0x204)]();const _0x556fb0=new THREE[(_0x4e6f2b(0x1bd))](0x404040),_0x215ddc=new THREE[(_0x4e6f2b(0x1e1))](0xffffff,0x444444,0x1);_0x215ddc[_0x4e6f2b(0x1ad)][_0x4e6f2b(0x20a)](0x0,0xc8,0x0),_0x49dd28['add'](_0x45fe7e),_0x49dd28[_0x4e6f2b(0x1dd)](_0x556fb0),_0x49dd28[_0x4e6f2b(0x1dd)](_0x215ddc);const _0x53d8b6=new THREE[(_0x4e6f2b(0x1f0))](_0x100a48,_0x5a870d[_0x4e6f2b(0x1e2)]);_0x53d8b6['enableDamping']=!![],_0x53d8b6[_0x4e6f2b(0x1cf)]=0.25,_0x53d8b6[_0x4e6f2b(0x1f1)]=!![],_0x53d8b6[_0x4e6f2b(0x1e5)]=0x32,_0x53d8b6[_0x4e6f2b(0x1c6)]=0x1f4,_0x53d8b6['mouseButtons']={'LEFT':THREE[_0x4e6f2b(0x1fa)][_0x4e6f2b(0x1da)],'MIDDLE':THREE[_0x4e6f2b(0x1fa)][_0x4e6f2b(0x210)],'RIGHT':THREE[_0x4e6f2b(0x1fa)][_0x4e6f2b(0x1d0)]},window['addEventListener'](_0x4e6f2b(0x1ab),function(_0x14b62c){const _0x30fa61=_0x4e6f2b;_0x14b62c['key']==='Control'&&(_0x53d8b6[_0x30fa61(0x1ee)][_0x30fa61(0x1e9)]=THREE[_0x30fa61(0x1fa)][_0x30fa61(0x1d0)]);}),window[_0x4e6f2b(0x1db)]('keyup',function(_0x3f14bd){const _0x351583=_0x4e6f2b;_0x3f14bd['key']==='Control'&&(_0x53d8b6[_0x351583(0x1ee)][_0x351583(0x1e9)]=THREE[_0x351583(0x1fa)][_0x351583(0x1da)]);});const _0x6e9f5e=document[_0x4e6f2b(0x1d7)](_0x4e6f2b(0x1c1));_0x6e9f5e[_0x4e6f2b(0x1db)](_0x4e6f2b(0x1c2),_0x1dabc9=>{const _0x17d579=_0x4e6f2b;_0x1dabc9[_0x17d579(0x1ca)](),_0x6e9f5e['style'][_0x17d579(0x213)]=_0x17d579(0x1e3);}),_0x6e9f5e['addEventListener'](_0x4e6f2b(0x1e0),()=>{const _0x558293=_0x4e6f2b;_0x6e9f5e[_0x558293(0x1c7)][_0x558293(0x213)]=_0x558293(0x1de);}),_0x6e9f5e[_0x4e6f2b(0x1db)](_0x4e6f2b(0x201),_0x2a10a3=>{const _0x1691e5=_0x4e6f2b;_0x2a10a3[_0x1691e5(0x1ca)](),_0x6e9f5e[_0x1691e5(0x1c7)][_0x1691e5(0x213)]='#ccc';const _0x476b43=_0x2a10a3[_0x1691e5(0x1be)][_0x1691e5(0x20d)][0x0];if(_0x476b43&&_0x476b43[_0x1691e5(0x1c8)][_0x1691e5(0x1b2)]('image/')){_0x363dde=_0x476b43[_0x1691e5(0x1b4)]['split']('.')[_0x1691e5(0x1cb)](0x0,-0x1)[_0x1691e5(0x1b8)]('.');const _0x49fee1=new FileReader();_0x49fee1[_0x1691e5(0x1ea)]=function(_0x36d30d){const _0x29cfa3=_0x1691e5,_0x955a73=new Image();_0x955a73[_0x29cfa3(0x1ea)]=function(){const _0x5c72aa=_0x29cfa3;_0x1a5bba=_0x955a73;const _0x1b9de9=parseFloat(document[_0x5c72aa(0x1d7)](_0x5c72aa(0x1d1))['value']),_0x3d6cc6=Math['PI']*_0x1b9de9,_0x53f5ba=parseFloat(document[_0x5c72aa(0x1d7)]('cylinderHeight')[_0x5c72aa(0x1dc)]),_0x41b793=_0x955a73[_0x5c72aa(0x202)]/_0x955a73[_0x5c72aa(0x1f3)];let _0x5fff8d=_0x41b793*_0x3d6cc6/_0x53f5ba*0x168;if(_0x5fff8d>0x168){const _0x4189b6=0x168/_0x5fff8d,_0x21adfb=_0x955a73[_0x5c72aa(0x202)]*_0x4189b6,_0x424a19=(_0x955a73[_0x5c72aa(0x202)]-_0x21adfb)/0x2,_0x3065c9=document[_0x5c72aa(0x20c)](_0x5c72aa(0x1ed)),_0x2f2db3=_0x3065c9[_0x5c72aa(0x1e4)]('2d');_0x3065c9['width']=_0x955a73[_0x5c72aa(0x1f3)],_0x3065c9['height']=_0x21adfb,_0x2f2db3['drawImage'](_0x955a73,0x0,_0x424a19,_0x955a73['width'],_0x21adfb,0x0,0x0,_0x955a73[_0x5c72aa(0x1f3)],_0x21adfb);const _0x6e4b47=new Image();_0x6e4b47[_0x5c72aa(0x1ea)]=function(){const _0x28c610=_0x5c72aa;_0x1a5bba=_0x6e4b47,_0x5fff8d=0x168,document[_0x28c610(0x1d7)](_0x28c610(0x1af))[_0x28c610(0x1dc)]=_0x5fff8d[_0x28c610(0x1f4)](0x2),_0x4f269b(_0x6e4b47);},_0x6e4b47['src']=_0x3065c9[_0x5c72aa(0x206)]();}else document['getElementById'](_0x5c72aa(0x1af))[_0x5c72aa(0x1dc)]=_0x5fff8d[_0x5c72aa(0x1f4)](0x2),_0x4f269b(_0x955a73);},_0x955a73[_0x29cfa3(0x1fb)]=_0x36d30d[_0x29cfa3(0x1d3)][_0x29cfa3(0x1b5)];},_0x49fee1[_0x1691e5(0x1f5)](_0x476b43);}}),document['getElementById'](_0x4e6f2b(0x1cd))[_0x4e6f2b(0x1db)]('click',()=>{_0x1a5bba&&(_0x78a4d9(_0x49dd28),_0x4f269b(_0x1a5bba));}),document['getElementById'](_0x4e6f2b(0x1d8))[_0x4e6f2b(0x1db)](_0x4e6f2b(0x1f8),()=>{const _0x5d9943=_0x4e6f2b,_0x39702f=prompt(_0x5d9943(0x1df),_0x363dde+'.stl');_0x39702f&&_0x1d0f7e(_0x49dd28,_0x39702f);});function _0x78a4d9(_0x29de5b){const _0xd9bb29=_0x4e6f2b;while(_0x29de5b['children']['length']>0x0){_0x29de5b[_0xd9bb29(0x1ba)](_0x29de5b[_0xd9bb29(0x1fd)][0x0]);}_0x29de5b[_0xd9bb29(0x1dd)](_0x45fe7e),_0x29de5b['add'](_0x556fb0),_0x29de5b[_0xd9bb29(0x1dd)](_0x215ddc);}function _0x4f269b(_0x4217e1){const _0x339982=_0x4e6f2b,_0x2ffd0d=new THREE[(_0x339982(0x1eb))](_0x4217e1);_0x2ffd0d[_0x339982(0x1b7)]=!![],_0x2ffd0d['wrapS']=THREE['RepeatWrapping'],_0x2ffd0d[_0x339982(0x1ce)]['x']=-0x1;const _0x16b38e=parseFloat(document[_0x339982(0x1d7)](_0x339982(0x1c4))[_0x339982(0x1dc)])/0x2,_0x5049b3=parseFloat(document[_0x339982(0x1d7)](_0x339982(0x1d1))['value'])/0x2,_0xdfff29=parseFloat(document[_0x339982(0x1d7)](_0x339982(0x1fc))[_0x339982(0x1dc)]),_0x5f479a=parseFloat(document[_0x339982(0x1d7)](_0x339982(0x1e8))[_0x339982(0x1dc)]),_0x546351=parseFloat(document[_0x339982(0x1d7)](_0x339982(0x1bf))['value']),_0x3ee539=parseFloat(document['getElementById'](_0x339982(0x1af))[_0x339982(0x1dc)]),_0x5d84d3=parseFloat(document['getElementById'](_0x339982(0x20e))[_0x339982(0x1dc)]),_0x47e328=_0x5f479a,_0x527455='\x0a\x20\x20\x20\x20\x20\x20\x20self.onmessage\x20=\x20function\x20(e)\x20{\x0a\x20\x20\x20\x20const\x20{\x20bottomRadius,\x20topRadius,\x20cylinderHeight,\x20stepHeight,\x20baseThickness,\x20surfaceAdjust,\x20textureAngle,\x20defaultThickness,\x20imageData\x20}\x20=\x20e.data;\x0a\x0a\x20\x20\x20\x20const\x20vertices\x20=\x20[];\x0a\x20\x20\x20\x20const\x20indices\x20=\x20[];\x0a\x0a\x20\x20\x20\x20const\x20totalSteps\x20=\x20Math.ceil(cylinderHeight\x20/\x20stepHeight)\x20*\x20Math.ceil(360\x20/\x20(360.0\x20/\x20(2\x20*\x20Math.PI\x20*\x20bottomRadius\x20/\x20stepHeight)));\x0a\x0a\x20\x20\x20\x20for\x20(let\x20y\x20=\x200;\x20y\x20<\x20cylinderHeight;\x20y\x20+=\x20stepHeight)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20normalizedY\x20=\x20y\x20/\x20cylinderHeight;\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20outerRadius\x20=\x20bottomRadius\x20+\x20(topRadius\x20-\x20bottomRadius)\x20*\x20normalizedY;\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20innerRadius\x20=\x20outerRadius\x20-\x20baseThickness;\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20circumference\x20=\x202\x20*\x20Math.PI\x20*\x20outerRadius;\x0a\x20\x20\x20\x20\x20\x20\x20\x20const\x20stepAngle\x20=\x20360.0\x20/\x20(circumference\x20/\x20stepHeight);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20(stepAngle\x20<=\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20console.error(\x27Invalid\x20stepAngle:\x27,\x20stepAngle);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20break;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20for\x20(let\x20angle\x20=\x200;\x20angle\x20<\x20360;\x20angle\x20+=\x20stepAngle)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20outerPosX1\x20=\x20outerRadius\x20*\x20Math.cos(angle\x20*\x20Math.PI\x20/\x20180.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20outerPosZ1\x20=\x20outerRadius\x20*\x20Math.sin(angle\x20*\x20Math.PI\x20/\x20180.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20outerPosX2\x20=\x20outerRadius\x20*\x20Math.cos((angle\x20+\x20stepAngle)\x20*\x20Math.PI\x20/\x20180.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20outerPosZ2\x20=\x20outerRadius\x20*\x20Math.sin((angle\x20+\x20stepAngle)\x20*\x20Math.PI\x20/\x20180.0);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20innerPosX1\x20=\x20innerRadius\x20*\x20Math.cos(angle\x20*\x20Math.PI\x20/\x20180.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20innerPosZ1\x20=\x20innerRadius\x20*\x20Math.sin(angle\x20*\x20Math.PI\x20/\x20180.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20innerPosX2\x20=\x20innerRadius\x20*\x20Math.cos((angle\x20+\x20stepAngle)\x20*\x20Math.PI\x20/\x20180.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20innerPosZ2\x20=\x20innerRadius\x20*\x20Math.sin((angle\x20+\x20stepAngle)\x20*\x20Math.PI\x20/\x20180.0);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20u\x20=\x20angle\x20/\x20textureAngle;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20v\x20=\x20normalizedY;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20boxDepth\x20=\x20stepHeight;\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20let\x20surfaceAdjustment\x20=\x20defaultThickness;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(angle\x20<=\x20textureAngle)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20pixelX\x20=\x20Math.min(Math.floor(u\x20*\x20imageData.width),\x20imageData.width\x20-\x201);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20pixelY\x20=\x20Math.min(Math.floor(v\x20*\x20imageData.height),\x20imageData.height\x20-\x201);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20pixelColor\x20=\x20getPixelColor(imageData,\x20pixelX,\x20pixelY);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20brightness\x20=\x20(pixelColor.r\x20+\x20pixelColor.g\x20+\x20pixelColor.b)\x20/\x203\x20/\x20255;\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20明るさが高いほど厚みが薄くなるように調整\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20surfaceAdjustment\x20=\x20(1\x20-\x20brightness)\x20*\x20surfaceAdjust;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20surfaceAdjustment\x20=\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20adjustedSurfaceAdjustment\x20=\x20Math.max(surfaceAdjustment,\x200.1);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20p0\x20=\x20{\x20x:\x20outerPosX1,\x20y:\x20y\x20-\x20boxDepth\x20/\x202,\x20z:\x20outerPosZ1\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20p1\x20=\x20{\x20x:\x20outerPosX1,\x20y:\x20y\x20+\x20boxDepth\x20/\x202,\x20z:\x20outerPosZ1\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20p2\x20=\x20{\x20x:\x20outerPosX2\x20+\x20adjustedSurfaceAdjustment\x20*\x20Math.cos((angle\x20+\x20stepAngle)\x20*\x20Math.PI\x20/\x20180.0),\x20y:\x20y\x20+\x20boxDepth\x20/\x202,\x20z:\x20outerPosZ2\x20+\x20adjustedSurfaceAdjustment\x20*\x20Math.sin((angle\x20+\x20stepAngle)\x20*\x20Math.PI\x20/\x20180.0)\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20p3\x20=\x20{\x20x:\x20outerPosX2\x20+\x20adjustedSurfaceAdjustment\x20*\x20Math.cos((angle\x20+\x20stepAngle)\x20*\x20Math.PI\x20/\x20180.0),\x20y:\x20y\x20-\x20boxDepth\x20/\x202,\x20z:\x20outerPosZ2\x20+\x20adjustedSurfaceAdjustment\x20*\x20Math.sin((angle\x20+\x20stepAngle)\x20*\x20Math.PI\x20/\x20180.0)\x20};\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20innerP0\x20=\x20{\x20x:\x20innerPosX1,\x20y:\x20y\x20-\x20boxDepth\x20/\x202,\x20z:\x20innerPosZ1\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20innerP1\x20=\x20{\x20x:\x20innerPosX1,\x20y:\x20y\x20+\x20boxDepth\x20/\x202,\x20z:\x20innerPosZ1\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20innerP2\x20=\x20{\x20x:\x20innerPosX2,\x20y:\x20y\x20+\x20boxDepth\x20/\x202,\x20z:\x20innerPosZ2\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20innerP3\x20=\x20{\x20x:\x20innerPosX2,\x20y:\x20y\x20-\x20boxDepth\x20/\x202,\x20z:\x20innerPosZ2\x20};\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20vertices.push(p0.x,\x20p0.y,\x20p0.z,\x20p1.x,\x20p1.y,\x20p1.z,\x20p2.x,\x20p2.y,\x20p2.z,\x20p3.x,\x20p3.y,\x20p3.z);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20vertices.push(innerP0.x,\x20innerP0.y,\x20innerP0.z,\x20innerP1.x,\x20innerP1.y,\x20innerP1.z,\x20innerP2.x,\x20innerP2.y,\x20innerP2.z,\x20innerP3.x,\x20innerP3.y,\x20innerP3.z);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20const\x20baseIndex\x20=\x20vertices.length\x20/\x203\x20-\x208;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20indices.push(baseIndex,\x20baseIndex\x20+\x201,\x20baseIndex\x20+\x202,\x20baseIndex,\x20baseIndex\x20+\x202,\x20baseIndex\x20+\x203);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20indices.push(baseIndex\x20+\x204,\x20baseIndex\x20+\x205,\x20baseIndex\x20+\x206,\x20baseIndex\x20+\x204,\x20baseIndex\x20+\x206,\x20baseIndex\x20+\x207);\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20//\x20表面と内側を繋ぐ側面を追加\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20indices.push(baseIndex,\x20baseIndex\x20+\x201,\x20baseIndex\x20+\x205,\x20baseIndex,\x20baseIndex\x20+\x205,\x20baseIndex\x20+\x204);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20indices.push(baseIndex\x20+\x201,\x20baseIndex\x20+\x202,\x20baseIndex\x20+\x206,\x20baseIndex\x20+\x201,\x20baseIndex\x20+\x206,\x20baseIndex\x20+\x205);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20indices.push(baseIndex\x20+\x202,\x20baseIndex\x20+\x203,\x20baseIndex\x20+\x207,\x20baseIndex\x20+\x202,\x20baseIndex\x20+\x207,\x20baseIndex\x20+\x206);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20indices.push(baseIndex\x20+\x203,\x20baseIndex,\x20baseIndex\x20+\x204,\x20baseIndex\x20+\x203,\x20baseIndex\x20+\x204,\x20baseIndex\x20+\x207);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20self.postMessage({\x20vertices,\x20indices\x20});\x0a};\x0a\x0afunction\x20getPixelColor(imageData,\x20x,\x20y)\x20{\x0a\x20\x20\x20\x20const\x20index\x20=\x20(y\x20*\x20imageData.width\x20+\x20x)\x20*\x204;\x0a\x20\x20\x20\x20return\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20r:\x20imageData.data[index],\x0a\x20\x20\x20\x20\x20\x20\x20\x20g:\x20imageData.data[index\x20+\x201],\x0a\x20\x20\x20\x20\x20\x20\x20\x20b:\x20imageData.data[index\x20+\x202]\x0a\x20\x20\x20\x20};\x0a}\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x57516b=new Blob([_0x527455],{'type':_0x339982(0x1e7)}),_0x264594=new Worker(URL[_0x339982(0x1f6)](_0x57516b));_0x264594[_0x339982(0x1ae)]({'bottomRadius':_0x16b38e,'topRadius':_0x5049b3,'cylinderHeight':_0xdfff29,'stepHeight':_0x5d84d3,'baseThickness':_0x5f479a,'surfaceAdjust':_0x546351,'textureAngle':_0x3ee539,'defaultThickness':_0x47e328,'imageData':_0xbbcfa8(_0x4217e1)}),_0x264594[_0x339982(0x1f7)]=function(_0x40bf2f){const _0x582e25=_0x339982,{vertices:_0x80da92,indices:_0x10b827}=_0x40bf2f[_0x582e25(0x1b6)],_0x3d608b=new THREE[(_0x582e25(0x212))]();_0x3d608b['setAttribute'](_0x582e25(0x1ad),new THREE['Float32BufferAttribute'](_0x80da92,0x3)),_0x3d608b[_0x582e25(0x209)](_0x10b827),_0x3d608b[_0x582e25(0x200)]();const _0x5cdcd8=new THREE['MeshStandardMaterial']({'map':_0x2ffd0d,'side':THREE[_0x582e25(0x208)],'roughness':0.5,'metalness':0.5}),_0x2cbd22=new THREE[(_0x582e25(0x207))](_0x3d608b,_0x5cdcd8);_0x49dd28[_0x582e25(0x1dd)](_0x2cbd22);};}function _0x1d0f7e(_0x325d84,_0x3c4098){const _0x40fc95=_0x4e6f2b,_0xfa5fed=new THREE[(_0x40fc95(0x1fe))](),_0x353826=_0xfa5fed[_0x40fc95(0x1c3)](_0x325d84,{'binary':!![]}),_0x587ab5=new Blob([_0x353826],{'type':_0x40fc95(0x1cc)}),_0x795946=document[_0x40fc95(0x20c)]('a');_0x795946[_0x40fc95(0x1c7)][_0x40fc95(0x1f9)]='none',document[_0x40fc95(0x1c9)][_0x40fc95(0x1d6)](_0x795946),_0x795946['href']=URL[_0x40fc95(0x1f6)](_0x587ab5),_0x795946['download']=_0x3c4098,_0x795946['click'](),document[_0x40fc95(0x1c9)][_0x40fc95(0x1c5)](_0x795946);}function _0x1535d1(){const _0x1f807d=_0x4e6f2b;requestAnimationFrame(_0x1535d1),_0x53d8b6[_0x1f807d(0x1b9)](),_0x5a870d[_0x1f807d(0x1ac)](_0x49dd28,_0x100a48);}_0x1535d1();function _0xbbcfa8(_0x2be361){const _0x155d27=_0x4e6f2b,_0x250fb7=document[_0x155d27(0x20c)]('canvas'),_0x4c5170=_0x250fb7[_0x155d27(0x1e4)]('2d');return _0x250fb7[_0x155d27(0x1f3)]=_0x2be361['width'],_0x250fb7[_0x155d27(0x202)]=_0x2be361['height'],_0x4c5170['translate'](_0x250fb7[_0x155d27(0x1f3)],_0x250fb7[_0x155d27(0x202)]),_0x4c5170[_0x155d27(0x1d5)](-0x1,-0x1),_0x4c5170['drawImage'](_0x2be361,0x0,0x0,_0x2be361[_0x155d27(0x1f3)],_0x2be361[_0x155d27(0x202)]),_0x4c5170[_0x155d27(0x1ef)](0x0,0x0,_0x2be361['width'],_0x2be361[_0x155d27(0x202)]);}}));function _0x1be8(_0x247506,_0xd43402){const _0x382852=_0x3828();return _0x1be8=function(_0x1be83e,_0x2d49e8){_0x1be83e=_0x1be83e-0x1ab;let _0x1bba7f=_0x382852[_0x1be83e];return _0x1bba7f;},_0x1be8(_0x247506,_0xd43402);}function _0x3828(){const _0x4f67e1=['update','remove','canvasContainer','8WqQjgn','AmbientLight','dataTransfer','contrastStrength','9vxRnrw','dropZone','dragover','parse','bottomDiameter','removeChild','maxDistance','style','type','body','preventDefault','slice','application/octet-stream','applySettings','repeat','dampingFactor','PAN','topDiameter','WebGLRenderer','target','15142320IhfYgG','scale','appendChild','getElementById','saveSettings','Scene','ROTATE','addEventListener','value','add','#ccc','ファイル名を入力してください:','dragleave','HemisphereLight','domElement','#000','getContext','minDistance','927llRtZJ','application/javascript','cylinderThickness','LEFT','onload','Texture','clientWidth','canvas','mouseButtons','getImageData','OrbitControls','screenSpacePanning','22ZQuzkv','width','toFixed','readAsDataURL','createObjectURL','onmessage','click','display','MOUSE','src','cylinderHeight','children','STLExporter','450849ezIXiq','computeVertexNormals','drop','height','196JdPiRw','normalize','3300430iLhaTU','toDataURL','Mesh','DoubleSide','setIndex','set','PerspectiveCamera','createElement','files','stepResolution','DOMContentLoaded','DOLLY','277818dsbwTS','BufferGeometry','borderColor','keydown','render','position','postMessage','textureAngle','4452360QHeAdq','innerHeight','startsWith','17615090gBMNjl','name','result','data','needsUpdate','join'];_0x3828=function(){return _0x4f67e1;};return _0x3828();}
    </script>
</body>
</html>
